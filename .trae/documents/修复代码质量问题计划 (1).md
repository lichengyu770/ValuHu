# 修复代码质量问题计划

## 问题分析

根据lint检查结果，项目中存在115个问题，其中10个错误，105个警告。主要问题类型包括：

1. **错误类型**：

   * 未使用的变量 (`@typescript-eslint/no-unused-vars`)

   * case块中的词法声明 (`no-case-declarations`)

2. **警告类型**：

   * 显式any类型 (`@typescript-eslint/no-explicit-any`)

   * React Hook依赖缺失 (`react-hooks/exhaustive-deps`)

   * React Refresh只支持组件导出 (`react-refresh/only-export-components`)

## 修复优先级

1. **错误修复**：首先修复所有错误，因为这些会导致构建失败
2. **React Hook依赖问题**：这些可能导致运行时错误
3. **显式any类型**：提高代码的类型安全性
4. **React Refresh警告**：提高开发体验

## 具体修复方案

### 1. 错误修复

| 文件路径                                           | 问题描述                         | 修复方案          |
| ---------------------------------------------- | ---------------------------- | ------------- |
| `src/components/MobileForm.tsx`                | 未使用的`isSubmitting`变量         | 移除该变量         |
| `src/components/SmsVerification/index.tsx`     | 未使用的`config`参数               | 移除该参数或添加下划线前缀 |
| `src/pages/ValuationEngine.tsx`                | 未使用的`FormSubmissionResult`类型 | 移除该类型导入       |
| `src/pages/ValuationEngine.tsx`                | 未使用的`ShareModal`组件           | 移除该组件导入       |
| `src/pages/ValuationEngine.tsx`                | case块中的词法声明                  | 在case块中添加大括号  |
| `src/pages/ValuationEngine/StepNavigation.tsx` | 未使用的`StepConfig`类型           | 移除该类型导入       |

### 2. React Hook依赖修复

| 文件路径                                   | 问题描述                                     | 修复方案               |
| -------------------------------------- | ---------------------------------------- | ------------------ |
| `src/components/BaiduMapComponent.tsx` | 缺失`updateHeatmap`依赖                      | 添加到useEffect依赖数组   |
| `src/components/BaiduMapComponent.tsx` | `mapServiceRef.current`在cleanup中的使用      | 复制到变量中使用           |
| `src/components/BaiduMapComponent.tsx` | 缺失`addPropertyMarkers`和`updateHeatmap`依赖 | 添加到useEffect依赖数组   |
| `src/components/Map/MapComponent.tsx`  | 缺失`mapInstance`和`selectedMarker`依赖       | 添加到useEffect依赖数组   |
| `src/pages/ValuationEngine.tsx`        | 缺失`reportService`依赖                      | 添加到useCallback依赖数组 |
| `src/pages/ValuationEngine.tsx`        | 缺失`fetchTemplates`依赖                     | 添加到useEffect依赖数组   |

### 3. 显式any类型修复

为所有显式any类型添加具体的类型定义，涉及多个文件，需要逐个分析和修复。

### 4. React Refresh警告修复

将常量和函数从组件文件中分离到单独的文件中：

| 文件路径                                                 | 问题描述  | 修复方案         |
| ---------------------------------------------------- | ----- | ------------ |
| `src/components/ChartLibrary/RechartsComponents.tsx` | 非组件导出 | 将常量和函数移至单独文件 |
| `src/components/ChartLibrary/index.tsx`              | 非组件导出 | 将常量和函数移至单独文件 |
| `src/components/LazyComponents.tsx`                  | 非组件导出 | 将常量和函数移至单独文件 |

## 执行步骤

1. 修复所有错误
2. 修复React Hook依赖问题
3. 修复显式any类型
4. 修复React Refresh警告
   5

